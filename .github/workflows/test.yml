name: test
on:
  push:
    branches:
      - main
  pull_request:
    branches:
      - '*'
jobs:
  prepare:
    uses: Yama-Tomo/graphql-subscription-playground/.github/workflows/tasks.yml@main
    with:
      task: generate
  lint:
    needs: prepare
    uses: Yama-Tomo/graphql-subscription-playground/.github/workflows/tasks.yml@main
    with:
      task: lint
  frontend-test:
    needs: prepare
    uses: Yama-Tomo/graphql-subscription-playground/.github/workflows/tasks.yml@main
    with:
      task: frontend_test
  bff-test:
    needs: prepare
    uses: Yama-Tomo/graphql-subscription-playground/.github/workflows/tasks.yml@main
    with:
      task: bff_test
  headless-browser-test:
    needs: prepare
    uses: Yama-Tomo/graphql-subscription-playground/.github/workflows/tasks.yml@main
    with:
      task: headless_browser_test
    secrets:
      PERCY_TOKEN: ${{ secrets.PERCY_TOKEN }}
      CYPRESS_PROJECT_ID: ${{ secrets.CYPRESS_PROJECT_ID }}
      CYPRESS_RECORD_KEY: ${{ secrets.CYPRESS_RECORD_KEY }}
